interactions:
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Type:
      - application/json
      User-Agent:
      - python-bugzilla/3.2.0
    method: GET
    uri: https://example.com/rest/version
  response:
    body:
      string: '{"version": "5.0.4.rh97"}'
    headers:
      Access-Control-Allow-Headers:
      - origin, content-type, accept, x-requested-with
      Access-Control-Allow-Origin:
      - '*'
      Cache-Control:
      - private, must-revalidate
      Connection:
      - keep-alive
      Content-Length:
      - '24'
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Thu, 13 Jun 2024 12:11:19 GMT
      Strict-Transport-Security:
      - max-age=63072000; includeSubDomains
      X-content-type-options:
      - nosniff
      X-xss-protection:
      - 1; mode=block
      x-rh-edge-cache-status:
      - Miss from child, Miss from parent
      x-rh-edge-reference-id:
      - 0.1d92645f.1718280679.3204d08c
      x-rh-edge-request-id:
      - 3204d08c
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Type:
      - application/json
      User-Agent:
      - python-bugzilla/3.2.0
    method: GET
    uri: https://example.com/rest/user?ids=1
  response:
    body:
      string: '{"users": [{"real_name": "Need Real Name", "can_login": true, "id":
        1, "email": "aander07@packetmaster.com", "name": "aander07@packetmaster.com"}]}'
    headers:
      Access-Control-Allow-Headers:
      - origin, content-type, accept, x-requested-with
      Access-Control-Allow-Origin:
      - '*'
      Cache-Control:
      - private, must-revalidate
      Connection:
      - keep-alive
      Content-Length:
      - '137'
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Thu, 13 Jun 2024 12:11:20 GMT
      Strict-Transport-Security:
      - max-age=63072000; includeSubDomains
      X-content-type-options:
      - nosniff
      X-xss-protection:
      - 1; mode=block
      x-rh-edge-cache-status:
      - Miss from child, Miss from parent
      x-rh-edge-reference-id:
      - 0.1d92645f.1718280679.3204d616
      x-rh-edge-request-id:
      - 3204d616
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Type:
      - application/json
      User-Agent:
      - python-bugzilla/3.2.0
    method: GET
    uri: https://example.com/rest/bug/607812?extra_fields=comments&extra_fields=description&extra_fields=external_bugs&extra_fields=flags&extra_fields=sub_components&extra_fields=tags
  response:
    body:
      string: '{"faults": [], "bugs": [{"qa_contact": "", "severity": "low", "summary":
        "CVE-2010-2239 libvirt: not setting user defined backing store format when
        creating new image", "assigned_to": "security-response-team@redhat.com", "cf_release_notes":
        "", "cf_clone_of": null, "docs_contact": "", "cf_fixed_in": "", "classification":
        "Other", "keywords": ["Security"], "cf_devel_whiteboard": "", "estimated_time":
        0, "is_creator_accessible": true, "cc_detail": [{"insider": true, "real_name":
        "Daniel Berrang\u00e9", "active": true, "email": "berrange@redhat.com", "name":
        "berrange@redhat.com", "partner": false, "id": 92433}, {"insider": true, "real_name":
        "Jiri Denemark", "active": true, "email": "jdenemar@redhat.com", "name": "jdenemar@redhat.com",
        "partner": false, "id": 270531}, {"active": true, "real_name": "J\u00e1n Rusna\u010dko",
        "insider": true, "id": 327381, "partner": false, "email": "jrusnack@redhat.com",
        "name": "jrusnack@redhat.com"}, {"id": 35599, "partner": false, "name": "mjc@redhat.com",
        "email": "mjc@redhat.com", "active": false, "real_name": "Mark J. Cox", "insider":
        false}, {"active": false, "real_name": "Red Hat Product Security", "insider":
        false, "id": 164808, "email": "security-response-team@redhat.com", "name":
        "security-response-team@redhat.com", "partner": false}, {"email": "vdanen@redhat.com",
        "name": "vdanen@redhat.com", "partner": false, "id": 275188, "insider": true,
        "real_name": "Vincent Danen", "active": true}, {"name": "veillard@redhat.com",
        "email": "veillard@redhat.com", "partner": false, "id": 40789, "insider":
        true, "real_name": "Daniel Veillard", "active": true}, {"active": true, "insider":
        false, "real_name": "Virtualization Maintenance", "email": "virt-maint@redhat.com",
        "partner": false, "name": "virt-maint@redhat.com", "id": 275247}, {"id": 196610,
        "name": "xen-maint@redhat.com", "partner": false, "email": "xen-maint@redhat.com",
        "active": false, "real_name": "Xen Maintainance List", "insider": false},
        {"id": 298442, "name": "yimwang@redhat.com", "email": "yimwang@redhat.com",
        "partner": false, "real_name": "wangyimiao", "insider": false, "active": false}],
        "tags": [], "remaining_time": 0, "cf_pgm_internal": "", "cf_qa_whiteboard":
        "", "product": "Security Response", "platform": "All", "actual_time": 0, "is_cc_accessible":
        true, "cf_major_incident": null, "op_sys": "Linux", "flags": [], "alias":
        ["CVE-2010-2239"], "cf_environment": "", "last_change_time": "2021-02-24T22:54:07Z",
        "cf_qe_conditional_nak": [], "sub_components": {}, "creator_detail": {"active":
        true, "insider": true, "real_name": "Petr Matousek", "email": "pmatouse@redhat.com",
        "name": "pmatouse@redhat.com", "partner": false, "id": 290312}, "cf_cust_facing":
        "---", "data_category": "Public", "assigned_to_detail": {"insider": false,
        "real_name": "Red Hat Product Security", "active": false, "email": "security-response-team@redhat.com",
        "partner": false, "name": "security-response-team@redhat.com", "id": 164808},
        "cf_build_id": "", "cc": ["berrange@redhat.com", "jdenemar@redhat.com", "jrusnack@redhat.com",
        "mjc@redhat.com", "security-response-team@redhat.com", "vdanen@redhat.com",
        "veillard@redhat.com", "virt-maint@redhat.com", "xen-maint@redhat.com", "yimwang@redhat.com"],
        "cf_srtnotes": "{\"affects\": [{\"affectedness\": \"notaffected\", \"cvss2\":
        null, \"cvss3\": null, \"impact\": null, \"ps_component\": \"libvirt\", \"ps_module\":
        \"rhel-6\", \"resolution\": null}, {\"affectedness\": \"affected\", \"cvss2\":
        \"1.5/AV:L/AC:M/Au:S/C:P/I:N/A:N\", \"cvss3\": null, \"impact\": \"low\",
        \"ps_component\": \"libvirt\", \"ps_module\": \"rhel-5.5.z\", \"resolution\":
        \"fix\"}, {\"affectedness\": \"affected\", \"cvss2\": \"1.5/AV:L/AC:M/Au:S/C:P/I:N/A:N\",
        \"cvss3\": null, \"impact\": \"low\", \"ps_component\": \"libvirt\", \"ps_module\":
        \"rhel-5.6\", \"resolution\": \"fix\"}, {\"affectedness\": \"affected\", \"cvss2\":
        null, \"cvss3\": null, \"impact\": null, \"ps_component\": \"libvirt\", \"ps_module\":
        \"fedora-all\", \"resolution\": \"fix\"}], \"cvss2\": \"4.4/AV:L/AC:M/Au:S/C:C/I:N/A:N\",
        \"impact\": \"moderate\", \"notes\": \"CVE-2010-2239 libvirt: not setting
        user defined backing store format when creating new image\", \"public\": \"2010-07-12\",
        \"reported\": \"2010-06-15\", \"source\": \"redhat\", \"statement\": \"(none)\"}",
        "cf_embargoed": null, "creation_time": "2010-06-24T22:03:29Z", "description":
        "It was found that libvirt did not explicitly set the user defined backing
        store\nformat when creating new image. This results in images being created
        with an\npotentialy insecure configuration, preventing applications from opening
        backing\nstores without resorting to probing. A priviledged guest user could
        use this flaw\nto access arbitrary files on the host.", "cf_conditional_nak":
        [], "target_release": ["---"], "target_milestone": "---", "resolution": "ERRATA",
        "cf_doc_type": "Bug Fix", "cf_internal_whiteboard": "", "dupe_of": null, "is_confirmed":
        true, "comments": [{"bug_id": 607812, "creator": "pmatouse@redhat.com", "creation_time":
        "2010-06-24T22:03:29Z", "time": "2010-06-24T22:03:29Z", "private_groups":
        [], "text": "It was found that libvirt did not explicitly set the user defined
        backing store\nformat when creating new image. This results in images being
        created with an\npotentialy insecure configuration, preventing applications
        from opening backing\nstores without resorting to probing. A priviledged guest
        user could use this flaw\nto access arbitrary files on the host.", "attachment_id":
        null, "count": 0, "is_private": false, "id": 2952826, "tags": [], "creator_id":
        290312}, {"creator": "pmatouse@redhat.com", "creation_time": "2010-07-12T11:27:47Z",
        "bug_id": 607812, "time": "2010-07-12T11:27:47Z", "private_groups": [], "text":
        "This issue affects libvirt >= 0.6.0.", "attachment_id": null, "creator_id":
        290312, "tags": [], "count": 3, "is_private": false, "id": 2996535}, {"private_groups":
        [], "text": "Created libvirt tracking bugs for this issue\n\nAffects: fedora-all
        [bug 613625]", "creation_time": "2010-07-12T13:03:27Z", "creator": "pmatouse@redhat.com",
        "bug_id": 607812, "time": "2010-07-12T13:03:27Z", "tags": [], "creator_id":
        290312, "count": 5, "id": 2996869, "is_private": false, "attachment_id": null},
        {"is_private": false, "count": 6, "id": 3033560, "creator_id": 184232, "tags":
        [], "attachment_id": null, "text": "libvirt-0.8.2-1.fc13 has been pushed to
        the Fedora 13 stable repository.  If problems still persist, please make note
        of it in this bug report.", "private_groups": [], "time": "2010-07-27T02:36:44Z",
        "bug_id": 607812, "creation_time": "2010-07-27T02:36:44Z", "creator": "updates@fedoraproject.org"},
        {"count": 7, "id": 3033630, "is_private": false, "creator_id": 184232, "tags":
        [], "attachment_id": null, "private_groups": [], "text": "libvirt-0.8.2-1.fc12
        has been pushed to the Fedora 12 stable repository.  If problems still persist,
        please make note of it in this bug report.", "bug_id": 607812, "creator":
        "updates@fedoraproject.org", "creation_time": "2010-07-27T02:48:41Z", "time":
        "2010-07-27T02:48:41Z"}, {"time": "2010-08-10T17:02:42Z", "bug_id": 607812,
        "creation_time": "2010-08-10T17:02:42Z", "creator": "errata-xmlrpc@redhat.com",
        "text": "This issue has been addressed in following products:\n\n  Red Hat
        Enterprise Linux 5\n\nVia RHSA-2010:0615 https://example.com/errata/RHSA-2010-0615.html",
        "private_groups": [], "attachment_id": null, "count": 9, "is_private": false,
        "id": 3070504, "tags": [], "creator_id": 241731}, {"tags": [], "creator_id":
        275188, "is_private": false, "id": 3071073, "count": 10, "attachment_id":
        null, "text": "Statement:\n\n(none)", "private_groups": [], "time": "2010-08-10T20:52:17Z",
        "creation_time": "2010-08-10T20:52:17Z", "creator": "vdanen@redhat.com", "bug_id":
        607812}, {"attachment_id": null, "count": 11, "id": 3097712, "is_private":
        false, "tags": [], "creator_id": 298442, "bug_id": 607812, "creation_time":
        "2010-08-23T04:53:10Z", "creator": "yimwang@redhat.com", "time": "2010-08-23T04:53:10Z",
        "private_groups": [], "text": "Verified passed this bug whith:\nlibvirt-0.8.1-21.el6.x86_64\nqemu-kvm-0.12.1.2-2.108.el6.x86_64\nqemu-img-0.12.1.2-2.108.el6.x86_64\nkernel-2.6.32-59.1.el6.x86_64.\n\nSteps:\n1.
        Prepare two image file, one is qcow2, another is raw.\n\n# qemu-img create
        -f qcow2 /var/lib/libvirt/images/backstore.img.orignal\n\nWrite some thing
        into the image file via qemu-io.\n# qemu-io /var/lib/libvirt/images/backstore.img.orignal
        1M\nqemu-io> write 0 64K -P65\n\n# qemu-img info backstore.img.orignal\nimage:
        backstore.img.orignal\nfile format: qcow2\nvirtual size: 1.0M (1048576 bytes)\ndisk
        size: 272K\ncluster_size: 65536\n\n# qemu-img create -f raw /var/lib/libvirt/images/backstore.img.replace
        1M\n\nWrite some thing into the image file via qemu-io.\n# qemu-io /var/lib/libvirt/images/backstore.img.replace\nqemu-io>
        write 0 64K -P66\n\n# qemu-img info backstore.img.replace\nimage: backstore.img.replace\nfile
        format: raw\nvirtual size: 1.0M (1048576 bytes)\ndisk size: 72K\n\n2. Prepare
        a vol xml with backing store set to some file in host.\n# cat vol.xml \n<volume>\n  <name>bug.img</name>\n  <key>/var/lib/libvirt/images/bug.img</key>\n  <source>\n  </source>\n  <capacity>1048576</capacity>\n  <allocation>147456</allocation>\n  <target>\n    <path>/var/lib/libvirt/images/bug.img</path>\n    <format
        type=''qcow2''/>\n  </target>\n  <backingStore>\n    <path>/var/lib/libvirt/images/backstore.img</path>\n    <format
        type=''qcow2''/>\n  </backingStore>\n</volume>\n\n3. Copy the qcow2 image
        file as backing store file.\n# cp backstore.img.orignal backstore.img\n\n4.
        Create volume via virsh command:\n# virsh vol-create default vol.xml\nVol
        bug.img created from vol.xml\n\n5. Replace the original qcow2 backing store
        file with a raw image file with the\nsame name.\n# cp backstore.img.replace
        backstore.img\n\n6. Attach the vol created in step 4 to guest as a secondary
        disk, and start\nguest.\n9. Try to start guest.\n# virsh start test \nerror:
        Failed to start domain test\nerror: internal error Process exited while reading
        console log output: char\ndevice redirected to /dev/pts/3\nqemu: could not
        open disk image /var/lib/libvirt/images/bug.img: Inappropriate\nioctl for
        device\n\nThe doamin can not start."}, {"private_groups": [], "text": "Another
        more explicit way to validate this bug is to check the contents of the Qcow2
        header. The header should contain a string specifying the format of the backing
        store\n\nStart with 3 xml files\n\n# cat vol0.xml\n<volume>\n  <name>vol0.img</name>\n  <capacity>1048576</capacity>\n  <allocation>0</allocation>\n  <target>\n    <path>/var/lib/libvirt/images/vol0.img</path>\n    <format
        type=''qcow2''/>\n  </target>\n</volume>\n\n# cat vol1.xml \n<volume>\n  <name>vol1.img</name>\n  <capacity>1048576</capacity>\n  <allocation>0</allocation>\n  <target>\n    <path>/var/lib/libvirt/images/vol1.img</path>\n    <format
        type=''qcow2''/>\n  </target>\n  <backingStore>\n    <path>/var/lib/libvirt/images/vol0.img</path>\n  </backingStore>\n</volume>\n\n#
        cat vol2.xml \n<volume>\n  <name>vol2.img</name>\n  <capacity>1048576</capacity>\n  <allocation>0</allocation>\n  <target>\n    <path>/var/lib/libvirt/images/vol2.img</path>\n    <format
        type=''qcow2''/>\n  </target>\n  <backingStore>\n    <path>/var/lib/libvirt/images/vol0.img</path>\n    <format
        type=''qcow2''/>\n  </backingStore>\n</volume>\n\nNotice that vol1.xml does
        not specify a backing storage format. So in the case of vol1, we should see
        backing format of ''raw'', and for vol2, we should see backing format of ''qcow2''.  With
        old broken libvirt, we don''t see either in the qemu file.\n\nNow create the
        volumes\n\n# virsh vol-create default vol0.xml\nVol vol0.img created from
        vol0.xml\n\n# virsh vol-create default vol1.xml\nVol vol1.img created from
        vol1.xml\n\n# virsh vol-create default vol2.xml\nVol vol2.img created from
        vol2.xml\n\n\nNow examine the headers either be opening the binary, or quicker
        by using ''strings''.\n\n# strings -n 3 /var/lib/libvirt/images/vol0.img \nQFI\n\n#
        strings -n 3 /var/lib/libvirt/images/vol1.img \nQFI\nraw\n/var/lib/libvirt/images/vol0.img\n\n#
        strings -n 3 /var/lib/libvirt/images/vol2.img \nQFI\nqcow2\n/var/lib/libvirt/images/vol0.img\n\n\nNow
        compare to what old libvirt would have done\n\n# strings -n 3 /var/lib/libvirt/images/vol1.img
        \nQFI\n/var/lib/libvirt/images/vol0.img\n\n# strings -n 3 /var/lib/libvirt/images/vol2.img
        \nQFI\n/var/lib/libvirt/images/vol0.img", "creator": "berrange@redhat.com",
        "creation_time": "2010-10-29T11:04:17Z", "bug_id": 607812, "time": "2010-10-29T11:04:17Z",
        "creator_id": 92433, "tags": [], "count": 12, "is_private": false, "id": 3243071,
        "attachment_id": null}], "priority": "low", "status": "CLOSED", "url": "",
        "external_bugs": [{"bug_id": 607812, "ext_description": "Low: libvirt security
        and bug fix update", "type": {"id": 139, "full_url": "https://example.com/errata/%id%",
        "can_get": 0, "send_once": 0, "must_send": 0, "type": "None", "url": "https://example.com/errata/",
        "can_send": 0, "description": "Red Hat Product Errata"}, "ext_priority": "normal",
        "ext_status": "SHIPPED_LIVE", "ext_bz_bug_id": "RHSA-2010:0615", "is_migration_link":
        0, "ext_bz_id": 139, "id": 685779}, {"id": 469243, "ext_priority": "normal",
        "ext_status": "SHIPPED_LIVE", "ext_bz_bug_id": "9808", "type": {"description":
        "Red Hat Errata Tool", "url": "https://example.com/", "type": "None", "can_send":
        0, "must_send": 0, "send_once": 0, "can_get": 0, "id": 140, "full_url": "https://example.com/advisory/%id%"},
        "is_migration_link": 0, "ext_bz_id": 140, "bug_id": 607812, "ext_description":
        "Low: libvirt security and bug fix update"}], "groups": [], "cf_last_closed":
        "2015-07-29T14:55:18Z", "version": ["unspecified"], "creator": "pmatouse@redhat.com",
        "cf_pm_score": "0", "is_open": false, "id": 607812, "depends_on": [613625,
        619104], "component": ["vulnerability"], "whiteboard": "", "deadline": null,
        "blocks": []}]}'
    headers:
      Access-Control-Allow-Headers:
      - origin, content-type, accept, x-requested-with
      Access-Control-Allow-Origin:
      - '*'
      Cache-Control:
      - private, must-revalidate
      Connection:
      - keep-alive
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Thu, 13 Jun 2024 12:11:20 GMT
      Strict-Transport-Security:
      - max-age=63072000; includeSubDomains
      Vary:
      - Accept-Encoding
      X-content-type-options:
      - nosniff
      X-xss-protection:
      - 1; mode=block
      content-length:
      - '14454'
      x-rh-edge-cache-status:
      - Miss from child, Miss from parent
      x-rh-edge-reference-id:
      - 0.1d92645f.1718280680.3204de86
      x-rh-edge-request-id:
      - 3204de86
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Type:
      - application/json
      User-Agent:
      - python-bugzilla/3.2.0
    method: GET
    uri: https://example.com/rest/bug/607812?extra_fields=comments&extra_fields=description&extra_fields=external_bugs&extra_fields=flags&extra_fields=sub_components&extra_fields=tags
  response:
    body:
      string: '{"bugs": [{"resolution": "ERRATA", "cf_doc_type": "Bug Fix", "cf_internal_whiteboard":
        "", "dupe_of": null, "is_confirmed": true, "comments": [{"private_groups":
        [], "text": "It was found that libvirt did not explicitly set the user defined
        backing store\nformat when creating new image. This results in images being
        created with an\npotentialy insecure configuration, preventing applications
        from opening backing\nstores without resorting to probing. A priviledged guest
        user could use this flaw\nto access arbitrary files on the host.", "bug_id":
        607812, "creator": "pmatouse@redhat.com", "creation_time": "2010-06-24T22:03:29Z",
        "time": "2010-06-24T22:03:29Z", "count": 0, "id": 2952826, "is_private": false,
        "creator_id": 290312, "tags": [], "attachment_id": null}, {"count": 3, "id":
        2996535, "is_private": false, "tags": [], "creator_id": 290312, "attachment_id":
        null, "private_groups": [], "text": "This issue affects libvirt >= 0.6.0.",
        "bug_id": 607812, "creation_time": "2010-07-12T11:27:47Z", "creator": "pmatouse@redhat.com",
        "time": "2010-07-12T11:27:47Z"}, {"bug_id": 607812, "creation_time": "2010-07-12T13:03:27Z",
        "creator": "pmatouse@redhat.com", "time": "2010-07-12T13:03:27Z", "private_groups":
        [], "text": "Created libvirt tracking bugs for this issue\n\nAffects: fedora-all
        [bug 613625]", "attachment_id": null, "count": 5, "id": 2996869, "is_private":
        false, "creator_id": 290312, "tags": []}, {"private_groups": [], "text": "libvirt-0.8.2-1.fc13
        has been pushed to the Fedora 13 stable repository.  If problems still persist,
        please make note of it in this bug report.", "creation_time": "2010-07-27T02:36:44Z",
        "creator": "updates@fedoraproject.org", "bug_id": 607812, "time": "2010-07-27T02:36:44Z",
        "creator_id": 184232, "tags": [], "id": 3033560, "count": 6, "is_private":
        false, "attachment_id": null}, {"time": "2010-07-27T02:48:41Z", "creator":
        "updates@fedoraproject.org", "creation_time": "2010-07-27T02:48:41Z", "bug_id":
        607812, "text": "libvirt-0.8.2-1.fc12 has been pushed to the Fedora 12 stable
        repository.  If problems still persist, please make note of it in this bug
        report.", "private_groups": [], "attachment_id": null, "creator_id": 184232,
        "tags": [], "is_private": false, "count": 7, "id": 3033630}, {"text": "This
        issue has been addressed in following products:\n\n  Red Hat Enterprise Linux
        5\n\nVia RHSA-2010:0615 https://example.com/errata/RHSA-2010-0615.html", "private_groups":
        [], "time": "2010-08-10T17:02:42Z", "creator": "errata-xmlrpc@redhat.com",
        "creation_time": "2010-08-10T17:02:42Z", "bug_id": 607812, "creator_id": 241731,
        "tags": [], "count": 9, "id": 3070504, "is_private": false, "attachment_id":
        null}, {"tags": [], "creator_id": 275188, "count": 10, "is_private": false,
        "id": 3071073, "attachment_id": null, "private_groups": [], "text": "Statement:\n\n(none)",
        "creator": "vdanen@redhat.com", "creation_time": "2010-08-10T20:52:17Z", "bug_id":
        607812, "time": "2010-08-10T20:52:17Z"}, {"text": "Verified passed this bug
        whith:\nlibvirt-0.8.1-21.el6.x86_64\nqemu-kvm-0.12.1.2-2.108.el6.x86_64\nqemu-img-0.12.1.2-2.108.el6.x86_64\nkernel-2.6.32-59.1.el6.x86_64.\n\nSteps:\n1.
        Prepare two image file, one is qcow2, another is raw.\n\n# qemu-img create
        -f qcow2 /var/lib/libvirt/images/backstore.img.orignal\n\nWrite some thing
        into the image file via qemu-io.\n# qemu-io /var/lib/libvirt/images/backstore.img.orignal
        1M\nqemu-io> write 0 64K -P65\n\n# qemu-img info backstore.img.orignal\nimage:
        backstore.img.orignal\nfile format: qcow2\nvirtual size: 1.0M (1048576 bytes)\ndisk
        size: 272K\ncluster_size: 65536\n\n# qemu-img create -f raw /var/lib/libvirt/images/backstore.img.replace
        1M\n\nWrite some thing into the image file via qemu-io.\n# qemu-io /var/lib/libvirt/images/backstore.img.replace\nqemu-io>
        write 0 64K -P66\n\n# qemu-img info backstore.img.replace\nimage: backstore.img.replace\nfile
        format: raw\nvirtual size: 1.0M (1048576 bytes)\ndisk size: 72K\n\n2. Prepare
        a vol xml with backing store set to some file in host.\n# cat vol.xml \n<volume>\n  <name>bug.img</name>\n  <key>/var/lib/libvirt/images/bug.img</key>\n  <source>\n  </source>\n  <capacity>1048576</capacity>\n  <allocation>147456</allocation>\n  <target>\n    <path>/var/lib/libvirt/images/bug.img</path>\n    <format
        type=''qcow2''/>\n  </target>\n  <backingStore>\n    <path>/var/lib/libvirt/images/backstore.img</path>\n    <format
        type=''qcow2''/>\n  </backingStore>\n</volume>\n\n3. Copy the qcow2 image
        file as backing store file.\n# cp backstore.img.orignal backstore.img\n\n4.
        Create volume via virsh command:\n# virsh vol-create default vol.xml\nVol
        bug.img created from vol.xml\n\n5. Replace the original qcow2 backing store
        file with a raw image file with the\nsame name.\n# cp backstore.img.replace
        backstore.img\n\n6. Attach the vol created in step 4 to guest as a secondary
        disk, and start\nguest.\n9. Try to start guest.\n# virsh start test \nerror:
        Failed to start domain test\nerror: internal error Process exited while reading
        console log output: char\ndevice redirected to /dev/pts/3\nqemu: could not
        open disk image /var/lib/libvirt/images/bug.img: Inappropriate\nioctl for
        device\n\nThe doamin can not start.", "private_groups": [], "time": "2010-08-23T04:53:10Z",
        "creator": "yimwang@redhat.com", "creation_time": "2010-08-23T04:53:10Z",
        "bug_id": 607812, "creator_id": 298442, "tags": [], "is_private": false, "count":
        11, "id": 3097712, "attachment_id": null}, {"text": "Another more explicit
        way to validate this bug is to check the contents of the Qcow2 header. The
        header should contain a string specifying the format of the backing store\n\nStart
        with 3 xml files\n\n# cat vol0.xml\n<volume>\n  <name>vol0.img</name>\n  <capacity>1048576</capacity>\n  <allocation>0</allocation>\n  <target>\n    <path>/var/lib/libvirt/images/vol0.img</path>\n    <format
        type=''qcow2''/>\n  </target>\n</volume>\n\n# cat vol1.xml \n<volume>\n  <name>vol1.img</name>\n  <capacity>1048576</capacity>\n  <allocation>0</allocation>\n  <target>\n    <path>/var/lib/libvirt/images/vol1.img</path>\n    <format
        type=''qcow2''/>\n  </target>\n  <backingStore>\n    <path>/var/lib/libvirt/images/vol0.img</path>\n  </backingStore>\n</volume>\n\n#
        cat vol2.xml \n<volume>\n  <name>vol2.img</name>\n  <capacity>1048576</capacity>\n  <allocation>0</allocation>\n  <target>\n    <path>/var/lib/libvirt/images/vol2.img</path>\n    <format
        type=''qcow2''/>\n  </target>\n  <backingStore>\n    <path>/var/lib/libvirt/images/vol0.img</path>\n    <format
        type=''qcow2''/>\n  </backingStore>\n</volume>\n\nNotice that vol1.xml does
        not specify a backing storage format. So in the case of vol1, we should see
        backing format of ''raw'', and for vol2, we should see backing format of ''qcow2''.  With
        old broken libvirt, we don''t see either in the qemu file.\n\nNow create the
        volumes\n\n# virsh vol-create default vol0.xml\nVol vol0.img created from
        vol0.xml\n\n# virsh vol-create default vol1.xml\nVol vol1.img created from
        vol1.xml\n\n# virsh vol-create default vol2.xml\nVol vol2.img created from
        vol2.xml\n\n\nNow examine the headers either be opening the binary, or quicker
        by using ''strings''.\n\n# strings -n 3 /var/lib/libvirt/images/vol0.img \nQFI\n\n#
        strings -n 3 /var/lib/libvirt/images/vol1.img \nQFI\nraw\n/var/lib/libvirt/images/vol0.img\n\n#
        strings -n 3 /var/lib/libvirt/images/vol2.img \nQFI\nqcow2\n/var/lib/libvirt/images/vol0.img\n\n\nNow
        compare to what old libvirt would have done\n\n# strings -n 3 /var/lib/libvirt/images/vol1.img
        \nQFI\n/var/lib/libvirt/images/vol0.img\n\n# strings -n 3 /var/lib/libvirt/images/vol2.img
        \nQFI\n/var/lib/libvirt/images/vol0.img", "private_groups": [], "time": "2010-10-29T11:04:17Z",
        "creator": "berrange@redhat.com", "creation_time": "2010-10-29T11:04:17Z",
        "bug_id": 607812, "creator_id": 92433, "tags": [], "count": 12, "is_private":
        false, "id": 3243071, "attachment_id": null}], "priority": "low", "status":
        "CLOSED", "url": "", "external_bugs": [{"id": 685779, "ext_description": "Low:
        libvirt security and bug fix update", "bug_id": 607812, "ext_bz_id": 139,
        "is_migration_link": 0, "type": {"must_send": 0, "can_get": 0, "send_once":
        0, "id": 139, "full_url": "https://example.com/errata/%id%", "description":
        "Red Hat Product Errata", "can_send": 0, "url": "https://example.com/errata/",
        "type": "None"}, "ext_bz_bug_id": "RHSA-2010:0615", "ext_status": "SHIPPED_LIVE",
        "ext_priority": "normal"}, {"id": 469243, "is_migration_link": 0, "ext_bz_id":
        140, "ext_bz_bug_id": "9808", "ext_priority": "normal", "ext_status": "SHIPPED_LIVE",
        "type": {"url": "https://example.com/", "type": "None", "can_send": 0, "description":
        "Red Hat Errata Tool", "send_once": 0, "can_get": 0, "id": 140, "full_url":
        "https://example.com/advisory/%id%", "must_send": 0}, "ext_description": "Low:
        libvirt security and bug fix update", "bug_id": 607812}], "groups": [], "cf_last_closed":
        "2015-07-29T14:55:18Z", "creator": "pmatouse@redhat.com", "version": ["unspecified"],
        "cf_pm_score": "0", "is_open": false, "id": 607812, "depends_on": [613625,
        619104], "component": ["vulnerability"], "whiteboard": "", "deadline": null,
        "blocks": [], "cf_major_incident": null, "op_sys": "Linux", "cf_environment":
        "", "flags": [], "alias": ["CVE-2010-2239"], "last_change_time": "2021-02-24T22:54:07Z",
        "cf_qe_conditional_nak": [], "sub_components": {}, "creator_detail": {"active":
        true, "insider": true, "real_name": "Petr Matousek", "email": "pmatouse@redhat.com",
        "name": "pmatouse@redhat.com", "partner": false, "id": 290312}, "cf_cust_facing":
        "---", "cf_build_id": "", "data_category": "Public", "assigned_to_detail":
        {"name": "security-response-team@redhat.com", "partner": false, "email": "security-response-team@redhat.com",
        "id": 164808, "active": false, "insider": false, "real_name": "Red Hat Product
        Security"}, "cc": ["berrange@redhat.com", "jdenemar@redhat.com", "jrusnack@redhat.com",
        "mjc@redhat.com", "security-response-team@redhat.com", "vdanen@redhat.com",
        "veillard@redhat.com", "virt-maint@redhat.com", "xen-maint@redhat.com", "yimwang@redhat.com"],
        "cf_srtnotes": "{\"affects\": [{\"affectedness\": \"notaffected\", \"cvss2\":
        null, \"cvss3\": null, \"impact\": null, \"ps_component\": \"libvirt\", \"ps_module\":
        \"rhel-6\", \"resolution\": null}, {\"affectedness\": \"affected\", \"cvss2\":
        \"1.5/AV:L/AC:M/Au:S/C:P/I:N/A:N\", \"cvss3\": null, \"impact\": \"low\",
        \"ps_component\": \"libvirt\", \"ps_module\": \"rhel-5.5.z\", \"resolution\":
        \"fix\"}, {\"affectedness\": \"affected\", \"cvss2\": \"1.5/AV:L/AC:M/Au:S/C:P/I:N/A:N\",
        \"cvss3\": null, \"impact\": \"low\", \"ps_component\": \"libvirt\", \"ps_module\":
        \"rhel-5.6\", \"resolution\": \"fix\"}, {\"affectedness\": \"affected\", \"cvss2\":
        null, \"cvss3\": null, \"impact\": null, \"ps_component\": \"libvirt\", \"ps_module\":
        \"fedora-all\", \"resolution\": \"fix\"}], \"cvss2\": \"4.4/AV:L/AC:M/Au:S/C:C/I:N/A:N\",
        \"impact\": \"moderate\", \"notes\": \"CVE-2010-2239 libvirt: not setting
        user defined backing store format when creating new image\", \"public\": \"2010-07-12\",
        \"reported\": \"2010-06-15\", \"source\": \"redhat\", \"statement\": \"(none)\"}",
        "cf_embargoed": null, "creation_time": "2010-06-24T22:03:29Z", "description":
        "It was found that libvirt did not explicitly set the user defined backing
        store\nformat when creating new image. This results in images being created
        with an\npotentialy insecure configuration, preventing applications from opening
        backing\nstores without resorting to probing. A priviledged guest user could
        use this flaw\nto access arbitrary files on the host.", "cf_conditional_nak":
        [], "target_release": ["---"], "target_milestone": "---", "is_creator_accessible":
        true, "cc_detail": [{"insider": true, "real_name": "Daniel Berrang\u00e9",
        "active": true, "email": "berrange@redhat.com", "name": "berrange@redhat.com",
        "partner": false, "id": 92433}, {"active": true, "insider": true, "real_name":
        "Jiri Denemark", "name": "jdenemar@redhat.com", "email": "jdenemar@redhat.com",
        "partner": false, "id": 270531}, {"real_name": "J\u00e1n Rusna\u010dko", "insider":
        true, "active": true, "id": 327381, "name": "jrusnack@redhat.com", "email":
        "jrusnack@redhat.com", "partner": false}, {"name": "mjc@redhat.com", "partner":
        false, "email": "mjc@redhat.com", "id": 35599, "insider": false, "real_name":
        "Mark J. Cox", "active": false}, {"insider": false, "real_name": "Red Hat
        Product Security", "active": false, "name": "security-response-team@redhat.com",
        "email": "security-response-team@redhat.com", "partner": false, "id": 164808},
        {"id": 275188, "name": "vdanen@redhat.com", "email": "vdanen@redhat.com",
        "partner": false, "real_name": "Vincent Danen", "insider": true, "active":
        true}, {"active": true, "insider": true, "real_name": "Daniel Veillard", "email":
        "veillard@redhat.com", "name": "veillard@redhat.com", "partner": false, "id":
        40789}, {"active": true, "insider": false, "real_name": "Virtualization Maintenance",
        "email": "virt-maint@redhat.com", "partner": false, "name": "virt-maint@redhat.com",
        "id": 275247}, {"insider": false, "real_name": "Xen Maintainance List", "active":
        false, "name": "xen-maint@redhat.com", "email": "xen-maint@redhat.com", "partner":
        false, "id": 196610}, {"name": "yimwang@redhat.com", "email": "yimwang@redhat.com",
        "partner": false, "id": 298442, "insider": false, "real_name": "wangyimiao",
        "active": false}], "tags": [], "remaining_time": 0, "cf_pgm_internal": "",
        "cf_qa_whiteboard": "", "product": "Security Response", "platform": "All",
        "actual_time": 0, "is_cc_accessible": true, "qa_contact": "", "severity":
        "low", "summary": "CVE-2010-2239 libvirt: not setting user defined backing
        store format when creating new image", "assigned_to": "security-response-team@redhat.com",
        "cf_release_notes": "", "cf_clone_of": null, "docs_contact": "", "cf_fixed_in":
        "", "classification": "Other", "keywords": ["Security"], "cf_devel_whiteboard":
        "", "estimated_time": 0}], "faults": []}'
    headers:
      Access-Control-Allow-Headers:
      - origin, content-type, accept, x-requested-with
      Access-Control-Allow-Origin:
      - '*'
      Cache-Control:
      - private, must-revalidate
      Connection:
      - keep-alive
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Thu, 13 Jun 2024 12:11:21 GMT
      Strict-Transport-Security:
      - max-age=63072000; includeSubDomains
      Vary:
      - Accept-Encoding
      X-content-type-options:
      - nosniff
      X-xss-protection:
      - 1; mode=block
      content-length:
      - '14454'
      x-rh-edge-cache-status:
      - Miss from child, Miss from parent
      x-rh-edge-reference-id:
      - 0.1d92645f.1718280680.3204eb7a
      x-rh-edge-request-id:
      - 3204eb7a
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Type:
      - application/json
      User-Agent:
      - python-bugzilla/3.2.0
    method: GET
    uri: https://example.com/rest/bug/607812/comment
  response:
    body:
      string: '{"comments": {}, "bugs": {"607812": {"comments": [{"attachment_id":
        null, "creator_id": 290312, "tags": [], "id": 2952826, "is_private": false,
        "count": 0, "time": "2010-06-24T22:03:29Z", "creator": "pmatouse@redhat.com",
        "creation_time": "2010-06-24T22:03:29Z", "bug_id": 607812, "text": "It was
        found that libvirt did not explicitly set the user defined backing store\nformat
        when creating new image. This results in images being created with an\npotentialy
        insecure configuration, preventing applications from opening backing\nstores
        without resorting to probing. A priviledged guest user could use this flaw\nto
        access arbitrary files on the host.", "private_groups": []}, {"private_groups":
        [], "text": "This issue affects libvirt >= 0.6.0.", "creator": "pmatouse@redhat.com",
        "creation_time": "2010-07-12T11:27:47Z", "bug_id": 607812, "time": "2010-07-12T11:27:47Z",
        "creator_id": 290312, "tags": [], "is_private": false, "count": 3, "id": 2996535,
        "attachment_id": null}, {"time": "2010-07-12T13:03:27Z", "creator": "pmatouse@redhat.com",
        "creation_time": "2010-07-12T13:03:27Z", "bug_id": 607812, "text": "Created
        libvirt tracking bugs for this issue\n\nAffects: fedora-all [bug 613625]",
        "private_groups": [], "attachment_id": null, "tags": [], "creator_id": 290312,
        "is_private": false, "count": 5, "id": 2996869}, {"tags": [], "creator_id":
        184232, "id": 3033560, "count": 6, "is_private": false, "attachment_id": null,
        "private_groups": [], "text": "libvirt-0.8.2-1.fc13 has been pushed to the
        Fedora 13 stable repository.  If problems still persist, please make note
        of it in this bug report.", "creation_time": "2010-07-27T02:36:44Z", "creator":
        "updates@fedoraproject.org", "bug_id": 607812, "time": "2010-07-27T02:36:44Z"},
        {"private_groups": [], "text": "libvirt-0.8.2-1.fc12 has been pushed to the
        Fedora 12 stable repository.  If problems still persist, please make note
        of it in this bug report.", "bug_id": 607812, "creation_time": "2010-07-27T02:48:41Z",
        "creator": "updates@fedoraproject.org", "time": "2010-07-27T02:48:41Z", "count":
        7, "is_private": false, "id": 3033630, "tags": [], "creator_id": 184232, "attachment_id":
        null}, {"text": "This issue has been addressed in following products:\n\n  Red
        Hat Enterprise Linux 5\n\nVia RHSA-2010:0615 https://example.com/errata/RHSA-2010-0615.html",
        "private_groups": [], "time": "2010-08-10T17:02:42Z", "creation_time": "2010-08-10T17:02:42Z",
        "creator": "errata-xmlrpc@redhat.com", "bug_id": 607812, "tags": [], "creator_id":
        241731, "id": 3070504, "is_private": false, "count": 9, "attachment_id": null},
        {"attachment_id": null, "tags": [], "creator_id": 275188, "count": 10, "is_private":
        false, "id": 3071073, "creation_time": "2010-08-10T20:52:17Z", "creator":
        "vdanen@redhat.com", "bug_id": 607812, "time": "2010-08-10T20:52:17Z", "private_groups":
        [], "text": "Statement:\n\n(none)"}, {"id": 3097712, "count": 11, "is_private":
        false, "tags": [], "creator_id": 298442, "attachment_id": null, "private_groups":
        [], "text": "Verified passed this bug whith:\nlibvirt-0.8.1-21.el6.x86_64\nqemu-kvm-0.12.1.2-2.108.el6.x86_64\nqemu-img-0.12.1.2-2.108.el6.x86_64\nkernel-2.6.32-59.1.el6.x86_64.\n\nSteps:\n1.
        Prepare two image file, one is qcow2, another is raw.\n\n# qemu-img create
        -f qcow2 /var/lib/libvirt/images/backstore.img.orignal\n\nWrite some thing
        into the image file via qemu-io.\n# qemu-io /var/lib/libvirt/images/backstore.img.orignal
        1M\nqemu-io> write 0 64K -P65\n\n# qemu-img info backstore.img.orignal\nimage:
        backstore.img.orignal\nfile format: qcow2\nvirtual size: 1.0M (1048576 bytes)\ndisk
        size: 272K\ncluster_size: 65536\n\n# qemu-img create -f raw /var/lib/libvirt/images/backstore.img.replace
        1M\n\nWrite some thing into the image file via qemu-io.\n# qemu-io /var/lib/libvirt/images/backstore.img.replace\nqemu-io>
        write 0 64K -P66\n\n# qemu-img info backstore.img.replace\nimage: backstore.img.replace\nfile
        format: raw\nvirtual size: 1.0M (1048576 bytes)\ndisk size: 72K\n\n2. Prepare
        a vol xml with backing store set to some file in host.\n# cat vol.xml \n<volume>\n  <name>bug.img</name>\n  <key>/var/lib/libvirt/images/bug.img</key>\n  <source>\n  </source>\n  <capacity>1048576</capacity>\n  <allocation>147456</allocation>\n  <target>\n    <path>/var/lib/libvirt/images/bug.img</path>\n    <format
        type=''qcow2''/>\n  </target>\n  <backingStore>\n    <path>/var/lib/libvirt/images/backstore.img</path>\n    <format
        type=''qcow2''/>\n  </backingStore>\n</volume>\n\n3. Copy the qcow2 image
        file as backing store file.\n# cp backstore.img.orignal backstore.img\n\n4.
        Create volume via virsh command:\n# virsh vol-create default vol.xml\nVol
        bug.img created from vol.xml\n\n5. Replace the original qcow2 backing store
        file with a raw image file with the\nsame name.\n# cp backstore.img.replace
        backstore.img\n\n6. Attach the vol created in step 4 to guest as a secondary
        disk, and start\nguest.\n9. Try to start guest.\n# virsh start test \nerror:
        Failed to start domain test\nerror: internal error Process exited while reading
        console log output: char\ndevice redirected to /dev/pts/3\nqemu: could not
        open disk image /var/lib/libvirt/images/bug.img: Inappropriate\nioctl for
        device\n\nThe doamin can not start.", "bug_id": 607812, "creator": "yimwang@redhat.com",
        "creation_time": "2010-08-23T04:53:10Z", "time": "2010-08-23T04:53:10Z"},
        {"tags": [], "creator_id": 92433, "is_private": false, "count": 12, "id":
        3243071, "attachment_id": null, "text": "Another more explicit way to validate
        this bug is to check the contents of the Qcow2 header. The header should contain
        a string specifying the format of the backing store\n\nStart with 3 xml files\n\n#
        cat vol0.xml\n<volume>\n  <name>vol0.img</name>\n  <capacity>1048576</capacity>\n  <allocation>0</allocation>\n  <target>\n    <path>/var/lib/libvirt/images/vol0.img</path>\n    <format
        type=''qcow2''/>\n  </target>\n</volume>\n\n# cat vol1.xml \n<volume>\n  <name>vol1.img</name>\n  <capacity>1048576</capacity>\n  <allocation>0</allocation>\n  <target>\n    <path>/var/lib/libvirt/images/vol1.img</path>\n    <format
        type=''qcow2''/>\n  </target>\n  <backingStore>\n    <path>/var/lib/libvirt/images/vol0.img</path>\n  </backingStore>\n</volume>\n\n#
        cat vol2.xml \n<volume>\n  <name>vol2.img</name>\n  <capacity>1048576</capacity>\n  <allocation>0</allocation>\n  <target>\n    <path>/var/lib/libvirt/images/vol2.img</path>\n    <format
        type=''qcow2''/>\n  </target>\n  <backingStore>\n    <path>/var/lib/libvirt/images/vol0.img</path>\n    <format
        type=''qcow2''/>\n  </backingStore>\n</volume>\n\nNotice that vol1.xml does
        not specify a backing storage format. So in the case of vol1, we should see
        backing format of ''raw'', and for vol2, we should see backing format of ''qcow2''.  With
        old broken libvirt, we don''t see either in the qemu file.\n\nNow create the
        volumes\n\n# virsh vol-create default vol0.xml\nVol vol0.img created from
        vol0.xml\n\n# virsh vol-create default vol1.xml\nVol vol1.img created from
        vol1.xml\n\n# virsh vol-create default vol2.xml\nVol vol2.img created from
        vol2.xml\n\n\nNow examine the headers either be opening the binary, or quicker
        by using ''strings''.\n\n# strings -n 3 /var/lib/libvirt/images/vol0.img \nQFI\n\n#
        strings -n 3 /var/lib/libvirt/images/vol1.img \nQFI\nraw\n/var/lib/libvirt/images/vol0.img\n\n#
        strings -n 3 /var/lib/libvirt/images/vol2.img \nQFI\nqcow2\n/var/lib/libvirt/images/vol0.img\n\n\nNow
        compare to what old libvirt would have done\n\n# strings -n 3 /var/lib/libvirt/images/vol1.img
        \nQFI\n/var/lib/libvirt/images/vol0.img\n\n# strings -n 3 /var/lib/libvirt/images/vol2.img
        \nQFI\n/var/lib/libvirt/images/vol0.img", "private_groups": [], "time": "2010-10-29T11:04:17Z",
        "creator": "berrange@redhat.com", "creation_time": "2010-10-29T11:04:17Z",
        "bug_id": 607812}]}}}'
    headers:
      Access-Control-Allow-Headers:
      - origin, content-type, accept, x-requested-with
      Access-Control-Allow-Origin:
      - '*'
      Cache-Control:
      - private, must-revalidate
      Connection:
      - keep-alive
      Content-Type:
      - application/json; charset=UTF-8
      Date:
      - Thu, 13 Jun 2024 12:11:22 GMT
      Strict-Transport-Security:
      - max-age=63072000; includeSubDomains
      Vary:
      - Accept-Encoding
      X-content-type-options:
      - nosniff
      X-xss-protection:
      - 1; mode=block
      content-length:
      - '8585'
      x-rh-edge-cache-status:
      - Miss from child, Miss from parent
      x-rh-edge-reference-id:
      - 0.1d92645f.1718280681.3204f8a4
      x-rh-edge-request-id:
      - 3204f8a4
    status:
      code: 200
      message: OK
version: 1
